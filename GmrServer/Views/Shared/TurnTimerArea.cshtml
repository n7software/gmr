@model GmrLib.Models.Game

@if (ViewBag.UserCanModifyGame)
{
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
        
    <script type="text/javascript">
        function EditTurnTimer() {
            var container = $('#turn-timer-container');
            $('#add-turn-timer').hide(200);
            container.show(200);
            setTimeout(function () {
                container.html('');
                container.addClass('turn-timer-load');

                $.post('@Url.Content("~/Game/EditTurnTimer/" + Model.GameID)', null, function (data) {
                    container.removeClass('turn-timer-load');
                    $('#turn-timer-area').html(data);
                }, 'html');
            }, 200);
        }

        function DisplayTurnTimer() {
            var container = $('#turn-timer-container');
            if (container) {
                container.html('');
                container.addClass('turn-timer-load');
            }

            $.post('@Url.Content("~/Game/DisplayTurnTimer/" + Model.GameID)', null, function (data) {
                if (container) {
                    container.removeClass('turn-timer-load');
                }
                if (data == '') {
                    container.hide(500);
                    setTimeout(function () {
                        $('#turn-timer-area').html('<div id="add-turn-timer" class="no-select" unselectable="on" onclick="EditTurnTimer();" style="display:none;" >Add Turn Timer</div><div id="turn-timer-container" style="display:none"></div>');
                        $('#add-turn-timer').show(500);
                    }, 500);
                }
                else {
                    $('#turn-timer-area').html(data);
                }
            }, 'html');
        }
    </script>
}
    
<div id="turn-timer-area" style="float:left; width:685px">
    @if (Model.TurnTimeLimit.HasValue)
    {
        var turnTimer = new GmrLib.Models.TurnTimer(Model);
        turnTimer.Editable = ViewBag.UserCanModifyGame;
        @Html.DisplayFor(g => turnTimer)
    }
    else if (ViewBag.UserCanModifyGame)
    {
        <div id="add-turn-timer" class="no-select" unselectable="on" onclick="EditTurnTimer();">
            Add Turn Timer
        </div>
        <div id="turn-timer-container" style="display:none">
        </div>
    }
</div>